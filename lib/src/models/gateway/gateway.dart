import 'package:dart_mappable/dart_mappable.dart';
import 'package:nyxx/src/utils/to_string_helper/to_string_helper.dart';

part 'gateway.mapper.dart';

/// {@template gateway_configuration}
/// Information about how to connect to the Gateway.
/// {@endtemplate}
@MappableClass()
class GatewayConfiguration with ToStringHelper, GatewayConfigurationMappable {
  /// The URL to connect to.
  final Uri url;

  /// {@macro gateway_configuration}
  /// @nodoc
  GatewayConfiguration({required this.url});
}

/// {@template gateway_bot}
/// Information about how to connect to the Gateway, with client-specific information.
/// {@endtemplate}
@MappableClass()
class GatewayBot extends GatewayConfiguration with GatewayBotMappable {
  /// The recommended number of shards to use.
  final int shards;

  /// Information about the client's session start limits.
  final SessionStartLimit sessionStartLimit;

  /// {@macro gateway_bot}
  /// @nodoc
  GatewayBot({
    required super.url,
    required this.shards,
    required this.sessionStartLimit,
  });
}

/// {@template session_start_limit}
/// Information about a client's session start limits.
/// {@endtemplate}
@MappableClass()
class SessionStartLimit with ToStringHelper, SessionStartLimitMappable {
  /// The total number of sessions that can be opened.
  final int total;

  /// The current number of sessions that have been opened.
  final int remaining;

  /// The time after which [remaining] will reset.
  final Duration resetAfter;

  /// The maximum number of concurrent shards identifying.
  final int maxConcurrency;

  /// {@macro session_start_limit}
  /// @nodoc
  SessionStartLimit({
    required this.total,
    required this.remaining,
    required this.resetAfter,
    required this.maxConcurrency,
  });
}
